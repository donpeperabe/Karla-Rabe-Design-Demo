{% extends 'base.html' %}
{% block content %}

<div class="dashboard-section">
    <h2>Editar Categoría</h2>
    
    <form method="POST" action="{{ url_for('dashboard_editar_categoria', category_id=category.id) }}" enctype="multipart/form-data">
        <div class="form-group">
            <label for="name">Nombre de la categoría:</label>
            <input type="text" id="name" name="name" value="{{ category.name }}" required>
        </div>
        
        <div class="form-group">
            <label for="description">Descripción:</label>
            <textarea id="description" name="description" rows="4">{{ category.description or '' }}</textarea>
        </div>
        
        <div class="form-group">
            <label for="cover_image">Imagen de portada actual:</label>
            {% if category.cover_image %}
            <div class="current-image">
                <img src="{{ url_for('static', filename='uploads/' ~ category.cover_image) }}" 
                     style="width: 200px; height: 200px; object-fit: cover; border-radius: 10px; display: block; margin: 10px 0;">
                <small>{{ category.cover_image }}</small>
            </div>
            {% else %}
            <p style="color: #666;">No hay imagen de portada</p>
            {% endif %}
            
            <label for="new_cover_image" style="margin-top: 15px; display: block;">Cambiar imagen de portada:</label>
            <input type="file" id="new_cover_image" name="cover_image" accept="image/*">
            <small>Dejar vacío para mantener la imagen actual</small>
        </div>
        
        <div class="form-actions">
            <button type="submit" class="btn-primary">Guardar Cambios</button>
            <a href="{{ url_for('dashboard_panel') }}" class="btn-secondary">Cancelar</a>
        </div>
    </form>
    
    <!-- Estadísticas de la categoría -->
    <div class="category-stats" style="margin-top: 30px; padding: 20px; background: #f9f9f9; border-radius: 10px;">
        <h4>Estadísticas de la Categoría</h4>
        <p><strong>Total de imágenes:</strong> {{ category.images|length }}</p>
        <p><strong>Creada:</strong> {{ category.id }} (ID de referencia)</p>
    </div>
    
    <!-- Eliminar categoría (con confirmación) -->
    <div class="danger-zone" style="margin-top: 30px; padding: 20px; background: #ffebee; border: 2px solid #f44336; border-radius: 10px;">
        <p style="color: #666; margin-bottom: 15px;">
            ⚠️ Eliminar esta categoría también eliminará todas las imágenes asociadas. Esta acción no se puede deshacer.
        </p>
        <form method="POST" action="{{ url_for('dashboard_eliminar_categoria', category_id=category.id) }}" 
              onsubmit="return confirm('¿Estás segura de que quieres eliminar esta categoría? Se eliminarán {{ category.images|length }} imágenes.')">
            <button type="submit" class="btn-danger">Eliminar Categoría</button>
        </form>
    </div>
</div>


{% endblock %}
